(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{222:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return d}));var r=function(data){if(!data)return"";var t=new Date(data).getDate(),e=new Date(data).getMonth()+1<10?"0".concat(new Date(data).getMonth()+1):new Date(data).getMonth()+1,n=new Date(data).getFullYear();return"".concat(n,"-").concat(e,"-").concat(t)},o=function(data){if(!data)return"";var t=new Date(data).getDate()<10?"0".concat(new Date(data).getDate()):new Date(data).getDate(),e=new Date(data).getMonth()+1<10?"0".concat(new Date(data).getMonth()+1):new Date(data).getMonth()+1,n=new Date(data).getFullYear(),r=new Date(data).getHours()<10?"0".concat(new Date(data).getHours()):new Date(data).getHours(),o=new Date(data).getMinutes()<10?"0".concat(new Date(data).getMinutes()):new Date(data).getMinutes();return"".concat(n,"-").concat(e,"-").concat(t,"T").concat(r,":").concat(o,":00")},c=function(data){if(!data)return"";var t=new Date(data).getDate()<10?"0".concat(new Date(data).getDate()):new Date(data).getDate(),e=new Date(data).getMonth()+1<10?"0".concat(new Date(data).getMonth()+1):new Date(data).getMonth()+1,n=new Date(data).getFullYear(),r=new Date(data).getHours()<10?"0".concat(new Date(data).getHours()):new Date(data).getHours(),o=new Date(data).getMinutes()<10?"0".concat(new Date(data).getMinutes()):new Date(data).getMinutes();return"".concat(t,".").concat(e,".").concat(n," ").concat(r,":").concat(o)},l=function(data){if(!data)return"";var t=new Date(data).getDate()<10?"0".concat(new Date(data).getDate()):new Date(data).getDate(),e=new Date(data).getMonth()+1<10?"0".concat(new Date(data).getMonth()+1):new Date(data).getMonth()+1,n=new Date(data).getFullYear();return"".concat(t,".").concat(e,".").concat(n)},d=function(t){return["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябырь","Декабырь"][t]}},272:function(t,e,n){var content=n(305);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(24).default)("6af2b495",content,!0,{sourceMap:!1})},304:function(t,e,n){"use strict";n(272)},305:function(t,e,n){var r=n(23)(!1);r.push([t.i,".sold[data-v-2ad43610]{padding:20px}.sold__filter[data-v-2ad43610]{width:30%;display:flex;justify-content:space-between;align-items:center}.sold__table[data-v-2ad43610]{border-spacing:0;border-collapse:collapse}.sold__table td[data-v-2ad43610],.sold__table th[data-v-2ad43610]{border:1px solid #000;padding:5px;text-align:center}.sold__table td .link[data-v-2ad43610],.sold__table th .link[data-v-2ad43610]{text-decoration:underline;cursor:pointer;border:none;background-color:initial}.sold__table-wrapper[data-v-2ad43610]{margin-top:15px}.sold__pagination-perpage[data-v-2ad43610]{margin-top:10px}.sold__pagination-total[data-v-2ad43610]{padding:10px 0;font-size:16px}.sold__pagination-page_control[data-v-2ad43610]{cursor:pointer;display:flex;flex-wrap:wrap}.sold__pagination-page_control div[data-v-2ad43610]{padding:5px}.sold__pagination-page_control div.active[data-v-2ad43610]{font-size:16px;font-weight:600}",""]),t.exports=r},338:function(t,e,n){"use strict";n.r(e);n(44),n(16),n(17),n(8),n(34),n(26);var r=n(10),o=(n(25),n(2)),c=n(35),l=n(222);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _={layout:"admin",asyncData:function(t){var e=t.$axios;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.get("/admin/solds",{params:{sellers:"",limit:100,page:1}});case 3:return n=t.sent,r=n.data,o=r.solds,c=r.totalCount,l=r.totalPages,t.abrupt("return",{currentPage:1,perPage:100,totalCount:c,totalPages:l,solds:o});case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},data:function(){return{payload:{seller:""},debounceSerch:null}},computed:v(v({},Object(c.b)({sellers:"codeBooks/sellers"})),{},{getOnlySeller:function(){return this.sellers.filter((function(t){return"manager"===t.role.key}))}}),watch:{currentPage:function(){this.getList()}},methods:{getFormatedDate:function(t){return Object(l.c)(t)},getNewPerPage:function(){this.currentPage=1,this.getList()},getList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get("/admin/solds",{params:{seller:t.payload.seller,limit:t.perPage,page:t.currentPage}});case 3:n=e.sent,r=n.data,o=r.solds,c=r.totalCount,l=r.totalPages,t.solds=o,t.totalCount=c,t.totalPages=l,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()},deleteSold:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.delete("/admin/solds/".concat(t));case 3:e.getList(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),console.log(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))()}}},f=(n(304),n(6)),component=Object(f.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sold"},[n("h1",[t._v("Продажи")]),t._v(" "),n("div",{staticClass:"sold__filter"},[n("div",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.payload.seller,expression:"payload.seller"}],on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.payload,"seller",e.target.multiple?n:n[0])},t.getList]}},[n("option",{attrs:{value:""}},[t._v("выберите продавца")]),t._v(" "),t._l(t.getOnlySeller,(function(e){return n("option",{key:e._id,domProps:{value:e._id}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],2)]),t._v(" "),n("div",[n("button",{on:{click:function(e){return t.$router.push("/admin-panel/sold/new-sold")}}},[t._v("\n        Добавить продажу\n      ")])])]),t._v(" "),n("div",{staticClass:"sold__table-wrapper"},[n("table",{staticClass:"sold__table"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._l(t.solds,(function(e){return n("tr",{key:e._id},[n("td",[t._v("\n          "+t._s(e.seller.map((function(t){return t.name})).join(", "))+"\n        ")]),t._v(" "),n("td",[t._v("\n          "+t._s(e.card?e.card.code:"")+"\n        ")]),t._v(" "),n("td",[t._v("\n          "+t._s(t.getFormatedDate(e.date))+"\n        ")]),t._v(" "),n("td",[t._v("\n          "+t._s(e.totalPrice)+"\n        ")]),t._v(" "),n("td",[t._v("\n          "+t._s(e.totalIncome)+"\n        ")]),t._v(" "),n("td",[n("NuxtLink",{staticClass:"link",attrs:{to:"/admin-panel/sold/"+e._id,tag:"div"}},[t._v("\n            E\n          ")])],1),t._v(" "),n("td",[n("button",{staticClass:"link",on:{click:function(n){return t.deleteSold(e._id)}}},[t._v("X")])])])}))],2)]),t._v(" "),n("div",{staticClass:"sold__pagination"},[n("div",{staticClass:"sold__pagination-perpage"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.perPage,expression:"perPage"}],on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.perPage=e.target.multiple?n:n[0]},t.getNewPerPage]}},[n("option",{attrs:{value:"10"}},[t._v("10")]),t._v(" "),n("option",{attrs:{value:"100"}},[t._v("100")]),t._v(" "),n("option",{attrs:{value:"1000"}},[t._v("1000")])])]),t._v(" "),n("div",{staticClass:"sold__pagination-total"},[t._v("Всего: "+t._s(t.totalCount))]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.totalPages>1,expression:"totalPages > 1"}],staticClass:"sold__pagination-page_control"},[n("div",{directives:[{name:"show",rawName:"v-show",value:1!==t.currentPage,expression:"currentPage !== 1"}],on:{click:function(e){t.currentPage=t.currentPage-1}}},[t._v("\n        <\n      ")]),t._v(" "),t._l(t.totalPages,(function(e){return n("div",{key:e,class:t.currentPage===e?"active":"",on:{click:function(n){t.currentPage=e}}},[t._v("\n        "+t._s(e)+"\n      ")])})),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.currentPage!==t.totalPages,expression:"currentPage !== totalPages"}],on:{click:function(e){t.currentPage=t.currentPage+1}}},[t._v("\n        >\n      ")])],2)])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th",{attrs:{rowspan:"2"}},[t._v("Продавец")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("Карта покупателя")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("Дата продажи")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("Сумма продажи")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("Доход")]),t._v(" "),n("th",{attrs:{colspan:"3"}},[t._v("Действия")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th",[t._v("Ред.")]),t._v(" "),n("th",[t._v("Удал.")])])}],!1,null,"2ad43610",null);e.default=component.exports}}]);